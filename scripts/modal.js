function l(e,t){let n=(t??document).querySelector(e);if(!n)throw Error(`Element "${e}" not found`);if(!(n instanceof HTMLElement))throw Error(`Element "${e}" is not an HTMLElement`);return n}function i(e,t){return[...(t??document).querySelectorAll(e)]}function o(e){return e instanceof HTMLElement}function r(e){return o(e)&&e.tagName==="DIALOG"}var a="https://esm.run/dialog-polyfill",c=window.HTMLDialogElement===void 0,m=i("[data-modal-id]"),s=new Map,d=e=>{if(!o(e.target))return;let t=e.target.closest("[data-modal-id]"),n=s.get(t);e.preventDefault(),n.showModal()},u=e=>{if(e.stopPropagation(),!o(e.target))return;let t=e.target.closest(".modal");r(t)&&t.close()},p=e=>{let t=e.currentTarget;e.target===t&&r(t)&&t.close()},E=e=>{if(!o(e.target))return;let t=e.target.closest(".modal__picture-wrapper");if(!o(t))return;t.parentNode?.querySelector(".modal__spinner")?.remove(),t.className+=" modal__picture-wrapper--loaded"},f=()=>{c&&document.querySelectorAll("dialog").forEach(async t=>{let{default:n}=await import(a);n.registerDialog(t)}),m.forEach(e=>{let t=l(`#${e.dataset.modalId}`);s.set(e,t),e.addEventListener("click",d),l(".modal__picture",t).addEventListener("load",E),t.addEventListener("click",p),l(".modal__button",t).addEventListener("click",u)})};export{f as init};
